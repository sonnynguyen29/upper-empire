{% comment %} sections/blog--image-gallery.liquid {% endcomment %}

<div class="blog-gallery">
  {% if section.blocks.size > 0 %}
    <div class="blog-gallery__grid">
      {% for block in section.blocks %}
        <div class="blog-gallery__item">
          {% if block.settings.image %}
            <a
              href="{{ block.settings.image | image_url }}"
              target="_blank"
              data-pswp-width="{{ block.settings.image.width }}"
              data-pswp-height="{{ block.settings.image.height }}"
            >
              {{
                block.settings.image
                | image_url: width: 600
                | image_tag:
                  class: 'blog-gallery__img',
                  alt: block.settings.image.alt,
                  loading: 'lazy',
                  width: 600,
                  height: 600
              }}
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>

<script>
  window.addEventListener('load', () => {
    const zoomInSVG =
      '<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="pswp__icn" id="pswp__icn--zoom-in"><path d="M6.66667 9.16667H9.16667M9.16667 9.16667H11.6667M9.16667 9.16667V6.66667M9.16667 9.16667V11.6667M14.1667 14.1667L17.5 17.5M2.5 9.16667C2.5 10.9348 3.20238 12.6305 4.45262 13.8807C5.70286 15.131 7.39856 15.8333 9.16667 15.8333C10.9348 15.8333 12.6305 15.131 13.8807 13.8807C15.131 12.6305 15.8333 10.9348 15.8333 9.16667C15.8333 7.39856 15.131 5.70286 13.8807 4.45262C12.6305 3.20238 10.9348 2.5 9.16667 2.5C7.39856 2.5 5.70286 3.20238 4.45262 4.45262C3.20238 5.70286 2.5 7.39856 2.5 9.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    const zoomOutSVG =
      '<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="pswp__icn" id="pswp__icn--zoom-out"><path d="M14.1667 14.1667L17.5 17.5M6.66667 9.16667H11.6667M2.5 9.16667C2.5 10.9348 3.20238 12.6305 4.45262 13.8807C5.70286 15.131 7.39856 15.8333 9.16667 15.8333C10.9348 15.8333 12.6305 15.131 13.8807 13.8807C15.131 12.6305 15.8333 10.9348 15.8333 9.16667C15.8333 7.39856 15.131 5.70286 13.8807 4.45262C12.6305 3.20238 10.9348 2.5 9.16667 2.5C7.39856 2.5 5.70286 3.20238 4.45262 4.45262C3.20238 5.70286 2.5 7.39856 2.5 9.16667Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    const zoomSVGs = zoomInSVG + zoomOutSVG;

    const lightbox = new window.PhotoSwipeLightbox({
      gallery: '.blog-gallery__grid',
      children: 'a',
      bgOpacity: 1,
      pswpModule: window.PhotoSwipe,
    });

    lightbox.init();
  });
</script>

{% schema %}
{
  "name": "Blog Image Gallery",
  "blocks": [
    {
      "type": "gallery_image",
      "name": "Gallery Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Blog Image Gallery",
      "blocks": [
        {
          "type": "gallery_image"
        },
        {
          "type": "gallery_image"
        },
        {
          "type": "gallery_image"
        }
      ]
    }
  ]
}
{% endschema %}

{% stylesheet %}
  .blog-gallery {
    margin: 40px auto;
    padding: 0 8px;
    max-width: 1440px;
  }

  .blog-gallery__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px 8px;
    width: 100%;
  }

  .blog-gallery__item {
    /* position: relative;
    padding-bottom: 100%; 
    width: 100%; */

    overflow: hidden;
  }

  .blog-gallery__item:hover .blog-gallery__img{
    transform: scale(1.1);
  }

  .blog-gallery__img {
    /* position: absolute;
    inset: 0; 
    width: 100%;
    height: 100%; */
    object-fit: cover;
    border-radius: 4px;
    height: 100%;
    aspect-ratio: 469.33/341.65;
    max-height: 100% !important;
    max-width: 100% !important;
    transition: 0.85s cubic-bezier(0.455, 0.03, 0.21, 0.985);
  }

  @media screen and (max-width: 768px) {
    .blog-gallery {
      padding: 0 8px;
    }

    .blog-gallery__grid {
      gap: 8px 8px;
      grid-template-columns: repeat(2, 1fr);
    }

    .blog-gallery__img {
      aspect-ratio: 175.5/127.75;
    }
  }
{% endstylesheet %}
