{{ 'blog--sneaker-highlight-spot.css' | asset_url | stylesheet_tag }}

{% schema %}
{
  "name": "Blog Sneaker Highlight",
  "settings": [
    {
      "type": "article",
      "id": "article_1",
      "label": "Article 1"
    },
    {
      "type": "article",
      "id": "article_2",
      "label": "Article 2"
    },
    {
      "type": "article",
      "id": "article_3",
      "label": "Article 3"
    }
  ],
  "presets": [
    {
      "name": "Blog Sneaker Highlight Spot",
      "category": "Blog"
    }
  ]
}
{% endschema %}

<div class="blog-sneaker-highlight-spot">
  <div class="blog-sneaker-highlight-spot__wrapper">
    <div class="blog-sneaker-highlight-spot__splide splide">
      <div class="splide__track">
        <ul class="splide__list">
          {% for i in (1..3) %}
            {% assign article_id = 'article_' | append: i %}
            {% if section.settings[article_id] != blank %}
              {% assign article = articles[section.settings[article_id]] %}
              <li class="splide__slide">
                <a href="{{ article.url }}" class="blog-sneaker-highlight-spot__article">
                  <div class="blog-sneaker-highlight-spot__article-image">
                    {% if article.image %}
                      {{
                        article.image
                        | image_url: width: 600
                        | image_tag: class: 'blog-sneaker-highlight-spot__article-img'
                      }}
                    {% else %}
                      {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                    {% endif %}
                  </div>
                  <div class="blog-sneaker-highlight-spot__article-content">
                    <h3 class="blog-sneaker-highlight-spot__article-title">{{ article.title }}</h3>
                    <p class="blog-sneaker-highlight-spot__article-meta">
                      <span class="blog-sneaker-highlight-spot__article-meta__date">
                        {% assign today_timestamp = 'now' | date: '%s' %}
                        {% assign published_timestamp = article.published_at | date: '%s' %}
                        {% assign seconds_difference = today_timestamp | minus: published_timestamp %}
                        {% assign days_difference = seconds_difference | divided_by: 86400 | floor %}

                        {% if days_difference == 0 %}
                          Today
                        {% elsif days_difference == 1 %}
                          a day ago
                        {% elsif days_difference < 7 %}
                          {{ days_difference }} days ago
                        {% else %}
                          {{ article.published_at | date: '%B %d, %Y' }}
                        {% endif %}
                      </span>

                      <span class="dot">
                        <svg xmlns="http://www.w3.org/2000/svg" width="4" height="5" viewBox="0 0 4 5" fill="none">
                          <circle cx="2" cy="2.47461" r="2" fill="#D9D9D9"/>
                        </svg>
                      </span>
                      <span
                        class="blog-sneaker-highlight-spot__article-meta__comments"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">
                          <g opacity="0.8">
                          <path d="M13.5 3.47461H2.50002C2.2348 3.47461 1.98045 3.57997 1.79291 3.7675C1.60537 3.95504 1.50002 4.20939 1.50002 4.47461V14.4746C1.49886 14.6653 1.55281 14.8523 1.65537 15.013C1.75793 15.1738 1.90473 15.3015 2.07814 15.3809C2.21029 15.4424 2.35425 15.4744 2.50002 15.4746C2.73477 15.474 2.96174 15.3903 3.14064 15.2384L3.14627 15.234L5.18752 13.4746H13.5C13.7652 13.4746 14.0196 13.3693 14.2071 13.1817C14.3947 12.9942 14.5 12.7398 14.5 12.4746V4.47461C14.5 4.20939 14.3947 3.95504 14.2071 3.7675C14.0196 3.57997 13.7652 3.47461 13.5 3.47461ZM13.5 12.4746H5.00002C4.87996 12.4747 4.76394 12.5179 4.67314 12.5965L2.50002 14.4746V4.47461H13.5V12.4746Z" fill="black"/>
                          </g>
                        </svg>
                        <span >
                          {{ article.comments_count }}
                        </span>
                      </span>
                    </p>
                  </div>
                </a>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
  const splide = new Splide('.splide', {
    type: 'loop',
    perPage: 1,
    perMove: 1,
    gap: '20px',
    mediaQuery: 'min',
    pagination: false,
    breakpoints: {
      768: {
        perPage: 2,
      },
      1024: {
        perPage: 3,
        arrows: false,
        type: 'slide',
      },
    },
  });
  splide.mount();
</script>
