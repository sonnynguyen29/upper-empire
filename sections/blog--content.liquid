{% comment %} sections/blog-content-blocks.liquid {% endcomment %}

{{ 'blog--content.css' | asset_url | stylesheet_tag }}

<div class="blog-content">
  {% for block in section.blocks %}
    {% case block.type %}
      {% when 'heading' %}
        <div class="blog-content__heading" {{ block.shopify_attributes }}>
          <h2 class="blog-content__heading-title" style="font-size: {{ block.settings.heading_size }}px;">
            {{ block.settings.title }}
          </h2>
        </div>

      {% when 'text' %}
        <div class="blog-content__text" {{ block.shopify_attributes }}>
          <p class="blog-content__text-paragraph">
            {{ block.settings.text }}
          </p>
        </div>

      {% when 'image' %}
        <div class="blog-content__image" {{ block.shopify_attributes }}>
          {% if block.settings.image %}
            <div class="blog-content__image-wrapper">
              {{
                block.settings.image
                | image_url: width: 1200
                | image_tag: class: 'blog-content__image-img', alt: block.settings.image.alt, loading: 'lazy'
              }}
            </div>
            {% if block.settings.caption != blank %}
              <p class="blog-content__image-caption">{{ block.settings.caption }}</p>
            {% endif %}
          {% endif %}
        </div>

      {% when 'video' %}
        <div class="blog-content__video" {{ block.shopify_attributes }}>
          {% if block.settings.video_source == 'url' and block.settings.video_url != blank %}
            <div class="blog-content__video-wrapper">
              {{ block.settings.video_url | video_tag: controls: true }}
            </div>
          {% elsif block.settings.video_source == 'file' and block.settings.video_file != blank %}
            <div class="blog-content__video-wrapper">
              {{
                block.settings.video_file
                | video_tag:
                  controls: true,
                  autoplay: block.settings.autoplay,
                  loop: block.settings.loop,
                  muted: block.settings.muted,
                  class: 'blog-content__video-file'
              }}
            </div>
          {% endif %}

          {% if block.settings.video_caption != blank %}
            <p class="blog-content__video-caption">{{ block.settings.video_caption }}</p>
          {% endif %}
        </div>

      {% when 'quote' %}
        <blockquote class="blog-content__quote" {{ block.shopify_attributes }}>
          <p class="blog-content__quote-text">{{ block.settings.quote_text }}</p>
          {% if block.settings.quote_author != blank %}
            <cite class="blog-content__quote-author">{{ block.settings.quote_author }}</cite>
          {% endif %}
        </blockquote>
      {% when 'horizontal_line' %}
        <style>
          .blog-content__horizontal-line {
            opacity: .3;
            background: #000;
            height: 1px;
          }
        </style>
        <hr class="blog-content__horizontal-line" />
    {% endcase %}
  {% endfor %}
</div>

{% schema %}
{
  "name": "Blog Content Blocks",
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading Text",
          "default": "Add your heading"
        },
        {
          "type": "range",
          "id": "heading_size",
          "min": 20,
          "max": 60,
          "step": 2,
          "unit": "px",
          "label": "Heading Size",
          "default": 32
        }
      ]
    },
    {
      "type": "text",
      "name": "Text Content",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Add your content here</p>"
        }
      ]
    },
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "caption",
          "label": "Caption"
        }
      ]
    },
    {
      "type": "video",
      "name": "Video",
      "settings": [
        {
          "type": "select",
          "id": "video_source",
          "label": "Video Source",
          "options": [
            {
              "value": "url",
              "label": "YouTube/Vimeo URL"
            },
            {
              "value": "file",
              "label": "Video File"
            }
          ],
          "default": "url"
        },
        {
          "type": "text",
          "id": "video_url",
          "label": "Video URL",
          "info": "YouTube or Vimeo URL"
        },
        {
          "type": "video",
          "id": "video_file",
          "label": "Video File",
          "info": "Upload or select a video file"
        },
        {
          "type": "checkbox",
          "id": "autoplay",
          "label": "Autoplay",
          "default": false,
          "info": "Video will be muted when autoplay is enabled"
        },
        {
          "type": "checkbox",
          "id": "loop",
          "label": "Loop Video",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "muted",
          "label": "Mute Video",
          "default": false
        },
        {
          "type": "text",
          "id": "video_caption",
          "label": "Video Caption"
        }
      ]
    },
    {
      "type": "quote",
      "name": "Quote",
      "settings": [
        {
          "type": "richtext",
          "id": "quote_text",
          "label": "Quote Text"
        },
        {
          "type": "text",
          "id": "quote_author",
          "label": "Quote Author"
        }
      ]
    },
    {
      "type": "horizontal_line",
      "name": "Horizontal Line"
    }
  ],
  "presets": [
    {
      "name": "Blog Content Blocks",
      "blocks": [
        {
          "type": "text"
        }
      ]
    }
  ]
}
{% endschema %}